package graphics;

import java.util.*;

/**
 * This class represents an image with an array of Strings.
 * You can see an String array as a two dimensional array of chars. 
 *
 */
public class Picture implements Iterable<String>{
    private String[] img;
	
    /**
     * It's only allowed create Pictures with static methods.
     * @param img, Character image.
    */
    private Picture(String[] img){
	this.img = img;
    }
    
    public String[] getImg() {
	return img;
    }
  /**
   * This must be used to invert the color of an image
   * @param c A character to be inverted (in color way)
   */
    private byte invColor(byte c){
	byte ic;
	switch (c) {
	    case '_': ic = '='; break;
	    case '=': ic = '_'; break;
	    case '.': ic = '@'; break;
	    case '@': ic = '.'; break;
	    default: ic = c; break;
	}
	return ic;
    }
	
  /**
   * used to overlay a the character c2 over the character c1
   * @param c1 the character over
   * @param c2 the character under
   */
    private byte overlay(byte c1, byte c2){
	if(c1 == ' ') return c2;
	    return c1;
    }
	
    // Methods implements for students
    public Picture invertir(){
	int len = this.img.length;
	String[] img = new String[len];
	for(int i = 0; i < len; i++){
	    img[i] = recorrerI(this.img[i]);
	}
	return new Picture(img);
    }

    private String recorrerI(String str){
	String nuevoStr = "";
	for(int i = 0; i < str.length(); i++){
	    byte actual = (byte)(str.charAt(i));
	    nuevoStr += (char)(invColor(actual));
	}
	return nuevoStr;
    }

    public Picture superponer(Picture p){
	int len = this.img.length;
	String[] img = new String[len];
	for(int i = 0; i < len; i++){
	    img[i] = recorrerS(this.img[i], p.img[i]);
	}
	return new Picture(img);
    }

    private String recorrerS(String str1, String str2){
	String newStr = "";
	for(int i = 0; i < str1.length(); i++){
		byte c1 = (byte)(str1.charAt(i));
		byte c2 = (byte)(str2.charAt(i));
		newStr += (char)(overlay(c1, c2));
	}
	return newStr;
    }
   
    public static Picture mergePicture(Picture[][] p){
	String[] img = new String[p.length * 58];
	Arrays.fill(img, ""); //evitar null en la concatenacion
	
	int index = 0;
	for(int i = 0; i < p.length; i++){
	    for(int j = 0; j < 58; j++){
		for(int k = 0; k < p[i].length; k++){
		    img[index] += p[i][k].img[j]; //concatenacion 
		}
		index++;
	    }
	}	
	return new Picture(img);
    }

   /**
   * returns a new Picture object that represents a pawn
   */
    
    public static Picture soldier1(){
	String[] img = { 
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                    #############                         ",
	    "                 #####.........#####                      ",
	    "              ####.................###                    ",
	    "            ###......................###                  ",
	    "          ####.........................###                ",
	    "         ###.............................###              ",
	    "        ###...............................###             ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.################................#####          ",
	    "       ######################..............########       ",
	    "      ####===================##............###....###     ",
	    "     ####=====================##...........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "      ####====================##...........###.....###    ",
	    "       ####==================##............###.....###    ",
	    "       #######################.............###.....###    ",
	    "       ###.##################..............###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###..............######.............###.....###    ",
	    "       ###.............#######.............###.....###    ",
	    "       ###............###..###.............###.....###    ",
	    "       ###.................###.............###.....###    ",
	    "       ###................ ###.............###.....###    ",
	    "       ###.................###.............###.....###    ",
	    "       ###.................###.............###.....###    ",
	    "       ###.................###.............###....###     ",
	    "       ###.................###.............########       ",
	    "       ###.................###.............#####          ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###..........###########............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "        ################     ################             ",
	    "           #########             #########                ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	};
	return new Picture(img);
    }
    
    public static Picture soldier2(){
	String[] img = { 
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                    #############                         ",
	    "                 #####.........#####                      ",
	    "              ####.................###                    ",
	    "            ###......................###                  ",
	    "          ####.........................###                ",
	    "         ###.............................###              ",
	    "        ###...............................###             ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.################................#####          ",
	    "       ######################..............########       ",
	    "      ####===================##............###....###     ",
	    "     ####=====================##...........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "      ####====================##...........###.....###    ",
	    "       ####==================##............###.....###    ",
	    "       #######################.............###.....###    ",
	    "       ###.##################..............###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........##.....................###.....###    ",
	    "       ###..........##.....................###....###     ",
	    "       ###..........#############..........########       ",
	    "       ###..........#############..........#####          ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###..........###########............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "        ################     ################             ",
	    "           #########             #########                ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	};
	return new Picture(img);
    }
    
    public static Picture soldier3(){
	String[] img = { 
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                    #############                         ",
	    "                 #####.........#####                      ",
	    "              ####.................###                    ",
	    "            ###......................###                  ",
	    "          ####.........................###                ",
	    "         ###.............................###              ",
	    "        ###...............................###             ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.################................#####          ",
	    "       ######################..............########       ",
	    "      ####===================##............###....###     ",
	    "     ####=====================##...........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "      ####====================##...........###.....###    ",
	    "       ####==================##............###.....###    ",
	    "       #######################.............###.....###    ",
	    "       ###.##################..............###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###.....................##..........###....###     ",
	    "       ###..........#############..........########       ",
	    "       ###..........#############..........#####          ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###..........###########............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "        ################     ################             ",
	    "           #########             #########                ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	};
	return new Picture(img);
    }

    public static Picture soldier4(){
	String[] img = { 
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                    #############                         ",
	    "                 #####.........#####                      ",
	    "              ####.................###                    ",
	    "            ###......................###                  ",
	    "          ####.........................###                ",
	    "         ###.............................###              ",
	    "        ###...............................###             ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.################................#####          ",
	    "       ######################..............########       ",
	    "      ####===================##............###....###     ",
	    "     ####=====================##...........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "      ####====================##...........###.....###    ",
	    "       ####==================##............###.....###    ",
	    "       #######################.............###.....###    ",
	    "       ###.##################..............###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###..........##.........##..........###.....###    ",
	    "       ###..........##.........##..........###.....###    ",
	    "       ###..........##.........##..........###.....###    ",
	    "       ###..........##.........##..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###.....................##..........###....###     ",
	    "       ###.....................##..........########       ",
	    "       ###.....................##..........#####          ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###..........###########............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "        ################     ################             ",
	    "           #########             #########                ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	};
	return new Picture(img);
    }

    public static Picture soldier5(){
	String[] img = { 
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                    #############                         ",
	    "                 #####.........#####                      ",
	    "              ####.................###                    ",
	    "            ###......................###                  ",
	    "          ####.........................###                ",
	    "         ###.............................###              ",
	    "        ###...............................###             ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.################................#####          ",
	    "       ######################..............########       ",
	    "      ####===================##............###....###     ",
	    "     ####=====================##...........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "     ####======================##..........###.....###    ",
	    "      ####====================##...........###.....###    ",
	    "       ####==================##............###.....###    ",
	    "       #######################.............###.....###    ",
	    "       ###.##################..............###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###.................................###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........##.....................###.....###    ",
	    "       ###..........##.....................###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###..........#############..........###.....###    ",
	    "       ###.....................##..........###.....###    ",
	    "       ###.....................##..........###....###     ",
	    "       ###..........#############..........########       ",
	    "       ###..........#############..........#####          ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###.................................###            ",
	    "       ###..........###########............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "       ###............###   ###............###            ",
	    "        ################     ################             ",
	    "           #########             #########                ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	    "                                                          ",
	};
	return new Picture(img);
    }

    public static Picture table(){
	String[] img = {
	    "##########################################################",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "#________________________________________________________#",
	    "##########################################################"
	};
	return new Picture(img);
    }

  /**
   * Returns an iterator over the pixels in the image. The iteration is over columns and rows.
   */
    private class PIterator implements Iterator<String>{
	private int index = 0;
	@Override
	public boolean hasNext() {
	    return index < img.length;
	}

	@Override
	public String next() {
	    assert index < img.length: "index="+index+"\timg.length="+img.length;
	    String s = img[index];
	    index++;
	    return s;
	}

	@Override
	public void remove() {
	    throw new UnsupportedOperationException("Not modification allowed");
	}
		
    }
	
    @Override
    public Iterator<String> iterator() {
	return new PIterator();
    }
}
